# Детекция лиц с каскадами Хаара

Скрипт `detect_faces.py` выполняет распознавание лиц на изображении с помощью каскадов Хаара (библиотека OpenCV) и включает базовую предобработку изображений, а также опциональные фильтры (проверка наличия глаз, детекция профиля, подавление дубликатов).

## Требования

* **Python**: 3.11
* Зависимости из `requirements.txt`:

  ```
  opencv-python>=4.9.0.80
  matplotlib>=3.8.0
  scikit-learn>=1.3.0
  numpy>=1.24.0
  ```

## Установка

1. Клонируйте или скачайте проект.
2. Установите зависимости:

   ```bash
   pip install -r requirements.txt
   ```

## Первый запуск

1. Подготовьте изображение (например `group.jpg`) в той же папке или укажите путь к файлу.
2. Запустите скрипт:

   ```bash
   python detect_faces.py --image group.jpg
   ```

   По умолчанию результат сохранится в файл `output_faces.png` и откроется окно с визуализацией.

## Полезные параметры

* `--scale` – масштабный коэффициент пирамиды поиска (по умолчанию 1.1).
* `--neighbors` – минимальное число соседей для подтверждения детекции (по умолчанию 5).
* `--minsize` – минимальный размер лица в пикселях (по умолчанию 60).
* `--check_eyes` – фильтрация по наличию глаз (уменьшает ложные срабатывания).
* `--with_profiles` – дополнительная детекция лиц в профиль.
* `--save` – имя файла для сохранения результата.

Пример:

```bash
python detect_faces.py -i group.jpg --check_eyes --with_profiles --save result.png
```

## Как это работает

1. **Загрузка и преобразование изображения**: конвертация BGR → RGB.
2. **Предобработка**: повышение контрастности (CLAHE) и лёгкое сглаживание шума.
3. **Детекция лиц**: каскады Хаара для анфас (и при опции — для профиля).
4. **Фильтрация (опционально)**: проверка наличия глаз.
5. **NMS**: подавление дубликатов перекрывающихся прямоугольников.
6. **Результат**: изображение с выделенными прямоугольниками вокруг найденных лиц сохраняется и показывается.
 